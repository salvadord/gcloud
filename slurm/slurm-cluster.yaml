# Copyright 2017 SchedMD LLC.
# Modified for use with the Slurm Resource Manager.
#
# Copyright 2015 Google Inc. All rights reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# [START cluster_yaml]
imports:
- path: slurm.jinja

resources:
- name: slurm-cluster
  type: slurm.jinja
  properties:
    cluster_name            : gcn
    static_node_count       : 1
    max_node_count          : 64000
    zone                    : us-central1-b
    region                  : us-central1
    cidr                    : 10.10.0.0/16

    controller_machine_type : n1-highmem-8  # n1-highmem-32
    compute_machine_type    : n1-standard-8
    login_machine_type      : n1-standard-1

    slurm_version           : 17.11.7
    default_account         : default
    default_users           : salvadord
    munge_key               : 9bc8d9bee6fcd2a15d9aaeed44afe795ac2d9bb234870bf48f1fde56c0b56c537d8098d2b82919e60d543af462ea913c0ae30e0a3b063f066326285f6a05e0ff

    controller_disk_size_gb : 200   # 2000
    login_disk_size_gb      : 10
    compute_disk_size_gb    : 10
    preemptible_bursting    : True

    # Optional compute configuration fields
    #external_compute_ips    : False
    #compute_disk_type       : pd-standard
    #controller_disk_type    : pd-standard
    #login_disk_type         : pd-standard

    # Optional GPU configuration fields
    # NOTE: This is currently functional for
    #   static nodes only.
    #gpu_type                : nvidia-tesla-k80
    #gpu_count               : 1

#  [END cluster_yaml]



